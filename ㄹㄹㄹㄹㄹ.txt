!strcmp("delivery_102_end", (const char*)doc["BucketState"]) 딜리버리102와 doc의state비교하는 명령


Detect_Patient에서 딜리버리 101을 오픈으로 업데이트하고
 while문으로 들감 근데 while문에서 스테이트 비교를 하는데 갑자기 end상태를 비교함????


StateInfo에는 로봇스테이트,버킷스테이트,캐비넷스테이트가 있고



http.begin(client, "http://medicinedb.codedbyjst.com/StateInfo/update?BucketState=med_100_end");
212번줄 StateInfo의 BucketState를 med_100_end로 업데이트 한것? 포스트를 해야하는거 아닌가?


import http.client
import json
import time

# HTTP 요청을 보낼 서버 정보
server = "medicinedb.codedbyjst.com"
port = 80

# 환자 정보 조회
conn = http.client.HTTPConnection(server, port)
conn.request("GET", "/PatientInfo/102")
response = conn.getresponse()
data = response.read()
conn.close()

# 조회 결과 파싱
doc = json.loads(data)
face_id = doc["FaceID"]

# 얼굴 인식 결과와 비교
if result.width >= 100 and result.height >= 120:
    if str(result.ID) == str(face_id):
        # 버킷 열기
        Bucket3_open()

        # 배달 시작 상태로 업데이트
        conn = http.client.HTTPConnection(server, port)
        conn.request("GET", "/StateInfo/update?BucketState=delivery_102_open")
        conn.getresponse()
        conn.close()

        # 배달 완료 상태까지 대기
        while True:
            conn = http.client.HTTPConnection(server, port)
            conn.request("GET", "/StateInfo")
            response = conn.getresponse()
            data = response.read()
            conn.close()

            doc = json.loads(data)
            bucket_state = doc["BucketState"]
            if bucket_state == "delivery_102_end":
                Bucket3_close()
                break

            print("Wait for touching")
            time.sleep(0.1)
else:
    print("Not in the Area")

